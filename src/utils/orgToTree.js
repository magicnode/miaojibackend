// import key from './key'

// const data = '[{ "createTime": "1532482858910", "id": 1, "idUsers": "", "location": "", "orgName": "超级管理员", "remark": "超级管理员" }, { "createTime": "1544422534075", "createUserId": 1, "createUserName": "超级管理员", "id": 66, "idUsers": "", "location": "", "orgName": "总部", "parentId": 1 }, { "createTime": "1544422758066", "createUserId": 95, "createUserName": "账号管理员", "id": 67, "idUsers": "", "location": "", "orgName": "总部", "parentId": 66 }, { "createTime": "1544422785100", "createUserId": 95, "createUserName": "账号管理员", "id": 68, "idUsers": "2513,2562,2602,2763,2764,2755,2785,2788,2799,2808,2809,2812,2813,2814,2815,2816,2817,2818,2825,2827,2828,2830,2831,2832,2833,2837,2838,2840,2841,2843,2852,2853,2856,2858,2859,2860,2861,2865,2871,2874,2875,2884,2889,2891,2892,2893,2900,2901,2905,2906,2911,2912,2941,2946,2947,2953", "location": "山东", "orgName": "山东区", "parentId": 66 }, { "createTime": "1544422976955", "createUserId": 95, "createUserName": "账号管理员", "id": 69, "idUsers": "2389,2609,2620,2619,2628,2627,2684,2773,2774,2823,2908,2929,2933,2936,2952,2958,2959,2963,2964,2965,2966,2967,2968,2969,2970,2971,2972,2973,2974,2975,2976,2977,2978,2979,2980,2981,2982,2983,2984,2985,2986,2987,2988,2989,2990,2991,2992,2993,2994,2995,2996,2997,2998,2999,3000,3001,3002,3003,3004,3005,3006,3007,3008,3009,3010,3011,3012,3013,3014,3015,3016,3017,3018,3019,3020,3021,3022,3035,3036,3040,3041,3042,3043,3044,3045,3046,3047,3048,3049,3053,3054,3070", "location": "广东", "orgName": "广东区", "parentId": 66 }, { "createTime": "1544422995563", "createUserId": 95, "createUserName": "账号管理员", "id": 70, "idUsers": "2339,2368,2335,2371,2387,2393,2362,2395,2385,2397,2398,2492,2499,2500,2496,2504,2506,2511,2512,2527,2530,2538,2539,2543,2547,2554,2553,2552,2551,2557,2559,2560,2561,2585,2608,2649,2695,2714,2715,2716,2731,2744,2745,2769,2779,2778,2801,2810,2842,2848,2851,2894,2917,2935,2945,2949,3051", "location": "上海", "orgName": "上海区", "parentId": 66 }, { "createTime": "1544423011691", "createUserId": 95, "createUserName": "账号管理员", "id": 71, "idUsers": "2523,2556,2563,2622,2621,2629,2632,2636,2637,2654,2666,2665,2673,2674,2677,2680,2687,2690,2712,2720,2738,2740,2750,2762,2787,2805,2806,2807,2783,2826,2834,2857,2863,2876,2877,2882,2909,2910,2938,2940,3064,3075", "location": "山西", "orgName": "山西区", "parentId": 66 }, { "createTime": "1544423046583", "createUserId": 95, "createUserName": "账号管理员", "id": 72, "idUsers": "2960,3068", "location": "河南", "orgName": "河南区", "parentId": 66 }, { "createTime": "1544431704390", "createUserId": 95, "createUserName": "账号管理员", "id": 73, "idUsers": "2513,2602,2755,2788,2900,2906,2953", "location": "山东,泰安", "orgName": "山东泰安", "parentId": 68 }, { "createTime": "1544432051393", "createUserId": 95, "createUserName": "账号管理员", "id": 74, "idUsers": "2799,2808,2809,2812,2813,2814,2815,2816,2817,2818,2825,2827,2828,2830,2831,2832,2833,2837,2838,2840,2841,2843,2852,2853,2856,2858,2859,2860,2861,2865,2874,2875,2884,2889,2891,2893,2901,2905,2911,2912", "location": "山东,德州", "orgName": "山东德州", "parentId": 68 }, { "createTime": "1544432070545", "createUserId": 95, "createUserName": "账号管理员", "id": 75, "idUsers": "2892,2941,2946,2947", "location": "山东,东营", "orgName": "山东东营", "parentId": 68 }, { "createTime": "1544432120086", "createUserId": 95, "createUserName": "账号管理员", "id": 76, "idUsers": "2609,2620,2619,2628,2627,2684,2908,2933,2959,2963,2964,2965,2966,2967,2968,2969,2970,2971,2972,2973,2974,2975,2976,2977,2978,2979,2980,2981,2982,2983,2984,2985,2986,2987,2988,2989,2990,2991,2992,2993,2994,2995,2996,2997,2998,2999,3000,3001,3002,3003,3004,3005,3006,3007,3008,3009,3010,3011,3012,3013,3014,3015,3016,3017,3018,3019,3020,3021,3022,3035,3036,3040,3041,3042,3043,3044,3045,3046,3047,3048,3053,3054", "location": "广东,佛山", "orgName": "广东佛山", "parentId": 69 }, { "createTime": "1544432149050", "createUserId": 95, "createUserName": "账号管理员", "id": 77, "idUsers": "2929,2936,2952,3049,3070", "location": "广东,珠海", "orgName": "广东珠海", "parentId": 69 }, { "createTime": "1544432193706", "createUserId": 95, "createUserName": "账号管理员", "id": 78, "idUsers": "2523,2622,2621,2629,2632,2636,2637,2654,2666,2665,2673,2674,2677,2680,2687,2690,2712,2720,2738,2740,2750,2762,2805,2806,2807,2783,2826,2834,2857,2863,2876,2877,2882,2909,2910,2938,2940", "location": "山西,太原", "orgName": "山西太原", "parentId": 71 }, { "createTime": "1544432218475", "createUserId": 95, "createUserName": "账号管理员", "id": 79, "idUsers": "2556,2563,2787", "location": "山西,晋中", "orgName": "山西晋中", "parentId": 71 }, { "createTime": "1544432252784", "createUserId": 95, "createUserName": "账号管理员", "id": 80, "idUsers": "", "location": "山西,临汾", "orgName": "山西临汾", "parentId": 71 }]'

const arrToTree = (arr = [], id = 1) => {
  const tmp = arr.filter(i => i.parentId === id)
  if (tmp.length > 0) {
    tmp.map((i) => {
      i.children = arrToTree(arr, i.id)
      if (i.children.length === 0) {
        delete i.children
      }
      return i
    })
  }
  return tmp
}

const filter = (arr) => {
  const tmp = arr.map((item) => {
    if (item.children) {
      item.children = filter(item.children)
    }

    return {
      value: item.id,
      label: item.orgName,
      children: item.children,
    }
  }).sort((a, b) => (a.children ? a.children.length : 0) - (b.children ? b.children.length : 0))
  return tmp
}

// const copy = (arr) => {
//   let tmp = []
//   arr.forEach((item) => {
//     if (item.children) {
//       tmp.push({ ...item, children: undefined })
//       item.children = copy(item.children)
//     }
//   })

//   return [...tmp, ...arr]
// }


const tree = (data) => {
  return filter(arrToTree(data))
}

export default tree
